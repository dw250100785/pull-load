/*! pull-load-0.0.1 2017-02-06 By Males , git:https://github.com/xiyan1120/pull-load.git*/!function(a,b){function c(a,b,c){b.addEventListener(a,function(a){c(a)})}function d(){var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAACgCAMAAACsXRuGAAAAt1BMVEX////FxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcU7SVrkAAAAPHRSTlMAAPONxyCMRvCjM2n59gzeD/xssVo52Akwh6sDpeTbckJLZroqfhUnRernVxifG9XDgb2ZzzxjeLThEmBcLCjmAAACDklEQVR4Xu2Y124yQQyFM9sh9BJafgik956/7fs/V4RCwiITbMdjCSGfKy4On7THnuLZ8yGTyRWUr1W54NgNIC4Dbm+VrQ+tbQxoQAMa0IAGnO4vtR44WBquCcBuJadrSslwQucNaBm2qbyHEQ3YqNN4l3fUKpdpMV7Q26ZF4T3S+5AU49OIA8RjvLpxDCAeY/PIcYB4jKf8tTzcxDt2fGBt/D3v19kPgK5fRQLkAt0MCZANdIdIgGxg7WBjgHygO1kTY/NVMla8QeBvJwHCGP84CRDG+PefBAhjrHTlo9n/InDiY9a7XfLazgewd//Jqze8AN15sAiw7Gu87XwAW/7m5ec5b+j8AXsveT6uSYAwxmrf7xNBZ+aYQJPJZDLh+20aRlkWhen8twdgnCyO0SCJfQDjUv6lUuwBmOQFJXJgGhSBQSoGhvmKQnFNo1VgBD3MmmarwAx6WDWFQOhh1RR+MvSwagqLwqw7/ndW3UkfCD2bhJcAephAvJGYn4y3OrMouIfZNriH19i4h7v0cI9ww4ce4ZEEPTt6/uJ+UdS4H28G1C9qV9yPLyjUL1vyuB/dlLh+dNtE/dpA+SdrF0XeNsqNLV96+puDfPvaaukfUvJjVP+gl19F9C9L8uuc/oVTfiXWv7TLxwr9wUc+msmHR/3xVj6A6z8RSBej/jMLp+76T1X6j2m7eP6aTO9STHV4CXebKAAAAABJRU5ErkJggg==",b='.pull-load-container {\tdisplay: -webkit-box;\tdisplay: -ms-flexbox;\tdisplay: flex;\t-webkit-box-pack: center;\t-ms-flex-pack: center;\tjustify-content: center;\t-webkit-box-align: center;\t-ms-flex-align: center;\talign-items: center;\tfont-size: 14px;\toverflow: hidden}.pull-load-down, .pull-load-up, .pull-load-empty-data {\tbackground:transparent;\tline-height:40px;\tpadding:0px 10px;\tfont-weight:bold;\tfont-size:14px;\tcolor:#888;}.pull-load-down .pull-load-down-icon, .pull-load-up .pull-load-up-icon  {\tdisplay: inline-block;\tvertical-align: middle;\tmargin-bottom: 5px;\twidth: 20px;\theight: 20px;\tbackground:url("'+a+'") 0 0 no-repeat;\t-webkit-background-size:cover; background-size:cover;\t-webkit-transition-property:-webkit-transform;\t-webkit-transition-duration:250ms;}.pull-load-down .pull-load-down-icon {\t-webkit-transform:rotate(0deg) translateZ(0);}.pull-load-up .pull-load-up-icon  {\t-webkit-transform:rotate(-180deg) translateZ(0);}.pull-load-down.flip .pull-load-down-icon {\tfont-size: 14px;\t-webkit-transform:rotate(-180deg) translateZ(0);}.pull-load-up.flip .pull-load-up-icon {\tfont-size: 14px;\t-webkit-transform:rotate(0deg) translateZ(0);}.pull-load-down.pull-load-loading .pull-load-down-icon, .pull-load-up.pull-load-loading .pull-load-up-icon {\tbackground-position:0 100%;\t-webkit-transform:rotate(0deg) translateZ(0);\t-webkit-transition-duration:0ms;\t-webkit-animation-name:loading;\t-webkit-animation-duration:2s;\t-webkit-animation-iteration-count:infinite;\t-webkit-animation-timing-function:linear;}@-webkit-keyframes loading {\tfrom { -webkit-transform:rotate(0deg) translateZ(0); }\tto { -webkit-transform:rotate(360deg) translateZ(0); }}',c="__pull_load_css",d=g.getElementById(c);d&&d.parentNode&&d.parentNode.removeChild(d),d=g.createElement("style"),d.id=c,d.type="text/css",d.styleSheet?d.styleSheet.cssText=b:d.innerHTML=b,g.getElementsByTagName("head")[0].appendChild(d)}function e(a){this.isTouchWebkit="ontouchstart"in f&&"WebKitCSSMatrix"in f,this.container=a.container,this.touchstart="touchstart",this.touchmove="touchmove",this.touchend="touchend",this.isTouchWebkit||(this.touchstart="mousedown",this.touchmove="mousemove",this.touchend="mouseup"),this.down=Object.assign({},{el:null,distance:50,container:'<div class="pull-load-container"></div>',init:'<div class="pull-load-down"><span><span class="pull-load-down-icon"></span>下拉刷新...</span></div>',loading:'<div class="pull-load-down pull-load-loading"><span class="pull-load-down-icon"></span>刷新中...</span></div>',release:'<div class="pull-load-down flip"><span><span class="pull-load-down-icon"></span>释放刷新...</span></div>',emptyData:'<div class="pull-load-empty-data">没有更多数据了</div>',time:1500,id:"_____pull_down____",enable:!0,callback:null},a.down?a.down:{}),this.up=Object.assign({},{el:null,distance:50,container:'<div class="pull-load-container"></div>',init:'<div class="pull-load-up"><span><span class="pull-load-up-icon"></span>上拉加载更多...</span></div>',loading:'<div class="pull-load-up pull-load-loading"><span class="pull-load-up-icon"></span>加载中...</span></div>',release:'<div class="pull-load-up flip"><span><span class="pull-load-up-icon"></span>释放加载...</span></div>',emptyData:'<div class="pull-load-empty-data">没有更多数据了</div>',time:1500,id:"_____pull_up____",enable:!0,isScrollLoad:!1,isInitLoad:!1,callback:null},a.up?a.up:{}),this.baseRefreshContainer='<div class="pull-load-container"></div>',this.startY=0,this.startScrollTop=0,this.type="",this.canRefresh=!1,this.canLoadMore=!1,this.isTouchStart=!1,this.isLoading=!1,this.isEmptyData=!1,this.hasInsertDom=!1,this.scrollLoadHasInsertDom=!1,d(),this.init()}var f=a,g=b;e.prototype={constructor:e,init:function(){var a=this,b=a.container;b&&(a.up.isInitLoad?(a.createDiv(a.up,!0,!0),a.upLoadMore(!0)):a.up.isScrollLoad&&a.createDiv(a.up,!0,!0),c(a.touchstart,b,function(){a.touch(event)}),c(a.touchmove,b,function(){a.touch(event)}),c(a.touchend,b,function(){a.touch(event)}),c("scroll",b,function(){a.scroll(event)}),a.isTouchWebkit||(b.onselectstart=function(){return!1},b.onselect=function(){g.selection.empty()},g.addEventListener(a.touchend,function(){a.touch(event)},!1)))},scroll:function(a,b,c){var d=this,e=d.up;if(!e.enable)return!1;var f=d.container;if(e.isScrollLoad&&!d.isLoading){var g=f.scrollHeight-(f.scrollTop+f.offsetHeight);if(e.init&&g-e.distance<0&&(d.scrollLoadHasInsertDom||d.createDiv(e,!0,!0)),b&&!d.isTouchWebkit){var h=Math.abs(c);f.scrollTop=d.startScrollTop+h}e.el&&g<=0&&d.upLoadMore()}},touch:function(a){var b=this,c=b.container;switch(a=a||f.event,b.isLoading&&a.preventDefault(),a.stopPropagation(),a.type){case b.touchstart:b.isLoading||(b.startY=b.pos(a).y,b.startScrollTop=c.scrollTop,b.isLoading=!1,b.canRefresh=!1,b.canLoadMore=!1,b.type="",b.isTouchStart=!0,b.hasInsertDom=!1);break;case b.touchmove:if(b.isTouchStart){if(!b.isTouchWebkit&&0===a.buttons)return b.end(),!1;var d=b.pos(a).y,e=d-b.startY;switch(b.type||(e<0?b.type="up":e>0&&(b.type="down")),b.type){case"up":b.up.isScrollLoad?b.scroll(a,!0,e):b.upAction(a,e);break;case"down":b.downAction(a,e)}}break;case b.touchend:b.end()}},end:function(){var a=this;if(a.isTouchStart=!1,a.canRefresh)a._end(a.down,!1);else if(a.canLoadMore)a._end(a.up,!0);else switch(a.type){case"up":a.back(a.up,!0);break;case"down":a.back(a.down,!1)}},_end:function(a,b){var c=this;return(!b||!a.isScrollLoad)&&void(b&&c.canLoadMore||!b&&c.canRefresh?(c.setCan(b,!1),c.setHeight(a.el,a.distance),c.transition(a.el,.5),a.el&&(a.el.innerHTML=a.loading),c.isLoading=!0,a.callback?a.callback(function(d){c.isEmptyData=d,c.back(a,b)}):setTimeout(function(){c.back(a,b)},a.time)):c.back(a,b))},back:function(a,b){var d=this;if(b){if(a.isScrollLoad)return!1}else;if(a.el){if(d.isEmptyData)return a.el.innerHTML=a.emptyData,a.enable=!1,d.isLoading=!1,!1;a.el.innerHTML=a.init,d.setHeight(a.el,0),d.transition(a.el,.5),c("webkitTransitionEnd",a.el,function(a){d.transitionEnd(a.target,b)}),c("transitionend",a.el,function(a){d.transitionEnd(a.target,b)})}},upAction:function(a,b){var c=this,d=c.container,e=c.up;if(!e.enable||!e.init)return!1;var f=d.scrollHeight-(d.scrollTop+d.offsetHeight);c.action(e.init&&f-e.distance<0&&!c.hasInsertDom,e,a,b,!0)},downAction:function(a,b){var c=this,d=c.container,e=c.down;if(!e.enable||!e.init)return!1;if(d.scrollTop>0){if(c.isTouchWebkit)return!1;var f=Math.abs(b);if(d.scrollTop=c.startScrollTop-f,d.scrollTop>0)return!1}c.action(!c.hasInsertDom,e,a,b,!1)},action:function(a,b,c,d,e){var f=this,g=f.container;a&&f.createDiv(b,e);var h="",i=0,j=Math.abs(d);if(e){var k=0;a&&(k=b.distance),j-=g.scrollTop+k-f.startScrollTop}else j-=f.startScrollTop;var l=Math.abs(b.distance);b.el?(c.cancelable&&c.preventDefault(),f.canRefresh=!1,f.canLoadMore=!1,j<=l?(i=j,h=b.init,f.setCan(e,!1)):j>l&&j<=2*l?(i=l+.5*(j-l),h=b.release,f.setCan(e,!0)):(i=l+.5*l+.2*(j-2*l),h=b.release,f.setCan(e,!0)),b.el.innerHTML=h,e?(f.isScrollLoad||g.scrollHeight!==g.offsetHeight||0!==g.scrollTop||i>=b.distance&&(i=b.distance),f.setHeight(b.el,i),g.scrollTop=i+g.scrollTop):f.setHeight(b.el,i)):e&&!f.isTouchWebkit&&(g.scrollTop=j+f.startScrollTop)},upLoadMore:function(a){var b=this,c=b.up;c.el&&(c.el.innerHTML=c.loading,b.isLoading=!0,c.callback&&c.callback(function(d){b.isLoading=!1,b.isEmptyData=d,c.el&&(d?(c.el.innerHTML=c.emptyData,c.enable=!1):c.el.innerHTML=c.init),a&&!c.isScrollLoad&&b.back(c,!0)}))},createDiv:function(a,b,d){var e=this,f=e.container;if(a.el=null,a.init){d?e.scrollLoadHasInsertDom=!0:e.hasInsertDom=!0;var h=g.createElement("div");a.container?h.innerHTML=a.container:h.innerHTML=e.baseRefreshContainer,a.el=h.childNodes[0],a.el.id||(a.el.id=a.id),a.el.innerHTML=a.init,a.id=a.el.id;var i=g.getElementById(a.id);i&&i.parentNode&&i.parentNode.removeChild(i),e.setHeight(a.el,b?a.distance:0),b?(f.appendChild(a.el),d&&c("click",a.el,function(){!e.isLoading&&a.enable&&e.upLoadMore()})):e.prependChild(f,a.el)}},setCan:function(a,b){var c=this;a?c.canLoadMore=b:c.canRefresh=b},pos:function(a){if(this.isTouchWebkit)return a.touches||(a.touches=a.originalEvent.touches),{x:a.touches[0].clientX,y:a.touches[0].clientY};a=a||f.event;var b=g.documentElement;return a.pageX?{x:a.pageX,y:a.pageY}:{x:a.clientX+b.scrollLeft-b.clientLeft,y:a.clientY+b.scrollTop-b.clientTop}},setHeight:function(a,b){a&&(a.style.height=b+"px")},transition:function(a,b){a&&(a.style.transition="transform "+b+"s ease-out",a.style.webkitTransition="-webkit-transform "+b+"s ease-out",a.style.transitionProperty="height",a.style.webkitTransitionProperty="height")},transitionEnd:function(a,b){var c=this;c.isLoading=!1,a.parentNode&&a.parentNode.removeChild(a),b?c.up.el=null:c.down.el=null},prependChild:function(a,b){a.hasChildNodes()?a.insertBefore(b,a.firstChild):a.appendChild(b)}},"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define([],function(){return e}):f.PullLoad=e}(window,document);
